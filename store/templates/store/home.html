{% extends 'store/base.html' %}

{% block content %}
    {% if user.is_authenticated %}
        <p>{{ user.email }}</p>
        <p>Deposit: {{ user.deposit }} $</p>
        <a href="{% url 'purchases' %}">Purchases</a>
        {% if user.is_superuser %}
            <a href="{% url 'add_product' %}">Create product</a>
        {% endif %}
        <a href="{% url 'logout' %}">Logout</a>
    {% else %}
        <a href="{% url 'login' %}">Login</a>
        <a href="{% url 'register' %}">Sign up</a>
    {% endif %}
    {% for product in object_list %}
        <div>
            <p>{{ product.title }}</p>
            <p>Description: {{ product.description }}</p>
            <p>Price: {{ product.price }} $</p>
            <p>Qty.: {{ product.quantity }}</p>
            {% if user.is_authenticated %}
                <form action="{% url 'add_purchase' pk=product.id %}" method="post">
                    {% csrf_token %}
                    {{ form.as_p }}
                    <button type="submit">Buy</button>
                </form>
            {% endif %}
            {% if user.is_superuser %}
                <a href="{% url 'update_product' product.id %}">Update product</a>
            {% endif %}
        </div>
    {% endfor %}
{% endblock %}
